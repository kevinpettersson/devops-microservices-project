{"ast":null,"code":"import { createAnatomy } from '@zag-js/anatomy';\nimport { raf, addDomEvent, getWindow, contains, getEventTarget, dataAttr, visuallyHiddenStyle, isSelfTarget } from '@zag-js/dom-query';\nimport { getAcceptAttrString, isFileEqual, isValidFileType, isValidFileSize, getFileEntries } from '@zag-js/file-utils';\nimport { formatBytes } from '@zag-js/i18n-utils';\nimport { createProps } from '@zag-js/types';\nimport { warn, callAll, createSplitProps, flatArray } from '@zag-js/utils';\nimport { createMachine } from '@zag-js/core';\n\n// src/file-upload.anatomy.ts\nvar anatomy = createAnatomy(\"file-upload\").parts(\"root\", \"dropzone\", \"item\", \"itemDeleteTrigger\", \"itemGroup\", \"itemName\", \"itemPreview\", \"itemPreviewImage\", \"itemSizeText\", \"label\", \"trigger\", \"clearTrigger\");\nvar parts = anatomy.build();\n\n// src/file-upload.dom.ts\nvar getRootId = ctx => ctx.ids?.root ?? `file:${ctx.id}`;\nvar getDropzoneId = ctx => ctx.ids?.dropzone ?? `file:${ctx.id}:dropzone`;\nvar getHiddenInputId = ctx => ctx.ids?.hiddenInput ?? `file:${ctx.id}:input`;\nvar getTriggerId = ctx => ctx.ids?.trigger ?? `file:${ctx.id}:trigger`;\nvar getLabelId = ctx => ctx.ids?.label ?? `file:${ctx.id}:label`;\nvar getItemId = (ctx, id) => ctx.ids?.item?.(id) ?? `file:${ctx.id}:item:${id}`;\nvar getItemNameId = (ctx, id) => ctx.ids?.itemName?.(id) ?? `file:${ctx.id}:item-name:${id}`;\nvar getItemSizeTextId = (ctx, id) => ctx.ids?.itemSizeText?.(id) ?? `file:${ctx.id}:item-size:${id}`;\nvar getItemPreviewId = (ctx, id) => ctx.ids?.itemPreview?.(id) ?? `file:${ctx.id}:item-preview:${id}`;\nvar getRootEl = ctx => ctx.getById(getRootId(ctx));\nvar getHiddenInputEl = ctx => ctx.getById(getHiddenInputId(ctx));\nvar getDropzoneEl = ctx => ctx.getById(getDropzoneId(ctx));\nfunction isEventWithFiles(event) {\n  const target = getEventTarget(event);\n  if (!event.dataTransfer) return !!target && \"files\" in target;\n  return event.dataTransfer.types.some(type => {\n    return type === \"Files\" || type === \"application/x-moz-file\";\n  });\n}\nfunction isFilesWithinRange(ctx, incomingCount, currentAcceptedFiles) {\n  const {\n    prop,\n    computed\n  } = ctx;\n  if (!computed(\"multiple\") && incomingCount > 1) return false;\n  if (!computed(\"multiple\") && incomingCount + currentAcceptedFiles.length === 2) return true;\n  if (incomingCount + currentAcceptedFiles.length > prop(\"maxFiles\")) return false;\n  return true;\n}\nfunction getEventFiles(ctx, files, currentAcceptedFiles = [], currentRejectedFiles = []) {\n  const {\n    prop,\n    computed\n  } = ctx;\n  const acceptedFiles = [];\n  const rejectedFiles = [];\n  const validateParams = {\n    acceptedFiles: currentAcceptedFiles,\n    rejectedFiles: currentRejectedFiles\n  };\n  files.forEach(file => {\n    const [accepted, acceptError] = isValidFileType(file, computed(\"acceptAttr\"));\n    const [sizeMatch, sizeError] = isValidFileSize(file, prop(\"minFileSize\"), prop(\"maxFileSize\"));\n    const validateErrors = prop(\"validate\")?.(file, validateParams);\n    const valid = validateErrors ? validateErrors.length === 0 : true;\n    if (accepted && sizeMatch && valid) {\n      acceptedFiles.push(file);\n    } else {\n      const errors = [acceptError, sizeError];\n      if (!valid) errors.push(...(validateErrors ?? []));\n      rejectedFiles.push({\n        file,\n        errors: errors.filter(Boolean)\n      });\n    }\n  });\n  if (!isFilesWithinRange(ctx, acceptedFiles.length, currentAcceptedFiles)) {\n    acceptedFiles.forEach(file => {\n      rejectedFiles.push({\n        file,\n        errors: [\"TOO_MANY_FILES\"]\n      });\n    });\n    acceptedFiles.splice(0);\n  }\n  return {\n    acceptedFiles,\n    rejectedFiles\n  };\n}\nfunction setInputFiles(inputEl, files) {\n  const win = getWindow(inputEl);\n  try {\n    if (\"DataTransfer\" in win) {\n      const dataTransfer = new win.DataTransfer();\n      files.forEach(file => {\n        dataTransfer.items.add(file);\n      });\n      inputEl.files = dataTransfer.files;\n    }\n  } catch {}\n}\n\n// src/file-upload.connect.ts\nfunction connect(service, normalize) {\n  const {\n    state,\n    send,\n    prop,\n    computed,\n    scope,\n    context\n  } = service;\n  const disabled = prop(\"disabled\");\n  const allowDrop = prop(\"allowDrop\");\n  const translations = prop(\"translations\");\n  const dragging = state.matches(\"dragging\");\n  const focused = state.matches(\"focused\") && !disabled;\n  return {\n    dragging,\n    focused,\n    disabled: !!disabled,\n    transforming: context.get(\"transforming\"),\n    openFilePicker() {\n      if (disabled) return;\n      send({\n        type: \"OPEN\"\n      });\n    },\n    deleteFile(file) {\n      send({\n        type: \"FILE.DELETE\",\n        file\n      });\n    },\n    acceptedFiles: context.get(\"acceptedFiles\"),\n    rejectedFiles: context.get(\"rejectedFiles\"),\n    setFiles(files) {\n      send({\n        type: \"FILES.SET\",\n        files,\n        count: files.length\n      });\n    },\n    clearRejectedFiles() {\n      send({\n        type: \"REJECTED_FILES.CLEAR\"\n      });\n    },\n    clearFiles() {\n      send({\n        type: \"FILES.CLEAR\"\n      });\n    },\n    getFileSize(file) {\n      return formatBytes(file.size, prop(\"locale\"));\n    },\n    createFileUrl(file, cb) {\n      const win = scope.getWin();\n      const url = win.URL.createObjectURL(file);\n      cb(url);\n      return () => win.URL.revokeObjectURL(url);\n    },\n    setClipboardFiles(dt) {\n      if (disabled) return false;\n      const items = Array.from(dt?.items ?? []);\n      const files = items.reduce((acc, item) => {\n        if (item.kind !== \"file\") return acc;\n        const file = item.getAsFile();\n        if (!file) return acc;\n        return [...acc, file];\n      }, []);\n      if (!files.length) return false;\n      send({\n        type: \"FILES.SET\",\n        files\n      });\n      return true;\n    },\n    getRootProps() {\n      return normalize.element({\n        ...parts.root.attrs,\n        dir: prop(\"dir\"),\n        id: getRootId(scope),\n        \"data-disabled\": dataAttr(disabled),\n        \"data-dragging\": dataAttr(dragging)\n      });\n    },\n    getDropzoneProps(props2 = {}) {\n      return normalize.element({\n        ...parts.dropzone.attrs,\n        dir: prop(\"dir\"),\n        id: getDropzoneId(scope),\n        tabIndex: disabled || props2.disableClick ? void 0 : 0,\n        role: props2.disableClick ? \"application\" : \"button\",\n        \"aria-label\": translations.dropzone,\n        \"aria-disabled\": disabled,\n        \"data-invalid\": dataAttr(prop(\"invalid\")),\n        \"data-disabled\": dataAttr(disabled),\n        \"data-dragging\": dataAttr(dragging),\n        onKeyDown(event) {\n          if (disabled) return;\n          if (event.defaultPrevented) return;\n          if (!isSelfTarget(event)) return;\n          if (props2.disableClick) return;\n          if (event.key !== \"Enter\" && event.key !== \" \") return;\n          send({\n            type: \"DROPZONE.CLICK\",\n            src: \"keydown\"\n          });\n        },\n        onClick(event) {\n          if (disabled) return;\n          if (event.defaultPrevented) return;\n          if (props2.disableClick) return;\n          if (!isSelfTarget(event)) return;\n          if (event.currentTarget.localName === \"label\") {\n            event.preventDefault();\n          }\n          send({\n            type: \"DROPZONE.CLICK\"\n          });\n        },\n        onDragOver(event) {\n          if (disabled) return;\n          if (!allowDrop) return;\n          event.preventDefault();\n          event.stopPropagation();\n          try {\n            event.dataTransfer.dropEffect = \"copy\";\n          } catch {}\n          const hasFiles = isEventWithFiles(event);\n          if (!hasFiles) return;\n          const count = event.dataTransfer.items.length;\n          send({\n            type: \"DROPZONE.DRAG_OVER\",\n            count\n          });\n        },\n        onDragLeave(event) {\n          if (disabled) return;\n          if (!allowDrop) return;\n          if (contains(event.currentTarget, event.relatedTarget)) return;\n          send({\n            type: \"DROPZONE.DRAG_LEAVE\"\n          });\n        },\n        onDrop(event) {\n          if (disabled) return;\n          if (allowDrop) {\n            event.preventDefault();\n            event.stopPropagation();\n          }\n          const hasFiles = isEventWithFiles(event);\n          if (disabled || !hasFiles) return;\n          getFileEntries(event.dataTransfer.items, prop(\"directory\")).then(files => {\n            send({\n              type: \"DROPZONE.DROP\",\n              files: flatArray(files)\n            });\n          });\n        },\n        onFocus() {\n          if (disabled) return;\n          send({\n            type: \"DROPZONE.FOCUS\"\n          });\n        },\n        onBlur() {\n          if (disabled) return;\n          send({\n            type: \"DROPZONE.BLUR\"\n          });\n        }\n      });\n    },\n    getTriggerProps() {\n      return normalize.button({\n        ...parts.trigger.attrs,\n        dir: prop(\"dir\"),\n        id: getTriggerId(scope),\n        disabled,\n        \"data-disabled\": dataAttr(disabled),\n        \"data-invalid\": dataAttr(prop(\"invalid\")),\n        type: \"button\",\n        onClick(event) {\n          if (disabled) return;\n          if (contains(getDropzoneEl(scope), event.currentTarget)) {\n            event.stopPropagation();\n          }\n          send({\n            type: \"OPEN\"\n          });\n        }\n      });\n    },\n    getHiddenInputProps() {\n      return normalize.input({\n        id: getHiddenInputId(scope),\n        tabIndex: -1,\n        disabled,\n        type: \"file\",\n        required: prop(\"required\"),\n        capture: prop(\"capture\"),\n        name: prop(\"name\"),\n        accept: computed(\"acceptAttr\"),\n        webkitdirectory: prop(\"directory\") ? \"\" : void 0,\n        multiple: computed(\"multiple\") || prop(\"maxFiles\") > 1,\n        onClick(event) {\n          event.stopPropagation();\n          event.currentTarget.value = \"\";\n        },\n        onInput(event) {\n          if (disabled) return;\n          const {\n            files\n          } = event.currentTarget;\n          send({\n            type: \"FILE.SELECT\",\n            files: files ? Array.from(files) : []\n          });\n        },\n        style: visuallyHiddenStyle\n      });\n    },\n    getItemGroupProps() {\n      return normalize.element({\n        ...parts.itemGroup.attrs,\n        dir: prop(\"dir\"),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemProps(props2) {\n      const {\n        file\n      } = props2;\n      return normalize.element({\n        ...parts.item.attrs,\n        dir: prop(\"dir\"),\n        id: getItemId(scope, file.name),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemNameProps(props2) {\n      const {\n        file\n      } = props2;\n      return normalize.element({\n        ...parts.itemName.attrs,\n        dir: prop(\"dir\"),\n        id: getItemNameId(scope, file.name),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemSizeTextProps(props2) {\n      const {\n        file\n      } = props2;\n      return normalize.element({\n        ...parts.itemSizeText.attrs,\n        dir: prop(\"dir\"),\n        id: getItemSizeTextId(scope, file.name),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemPreviewProps(props2) {\n      const {\n        file\n      } = props2;\n      return normalize.element({\n        ...parts.itemPreview.attrs,\n        dir: prop(\"dir\"),\n        id: getItemPreviewId(scope, file.name),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemPreviewImageProps(props2) {\n      const {\n        file,\n        url\n      } = props2;\n      const isImage = file.type.startsWith(\"image/\");\n      if (!isImage) {\n        throw new Error(\"Preview Image is only supported for image files\");\n      }\n      return normalize.img({\n        ...parts.itemPreviewImage.attrs,\n        alt: translations.itemPreview?.(file),\n        src: url,\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemDeleteTriggerProps(props2) {\n      const {\n        file\n      } = props2;\n      return normalize.button({\n        ...parts.itemDeleteTrigger.attrs,\n        dir: prop(\"dir\"),\n        type: \"button\",\n        disabled,\n        \"data-disabled\": dataAttr(disabled),\n        \"aria-label\": translations.deleteFile?.(file),\n        onClick() {\n          if (disabled) return;\n          send({\n            type: \"FILE.DELETE\",\n            file\n          });\n        }\n      });\n    },\n    getLabelProps() {\n      return normalize.label({\n        ...parts.label.attrs,\n        dir: prop(\"dir\"),\n        id: getLabelId(scope),\n        htmlFor: getHiddenInputId(scope),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getClearTriggerProps() {\n      return normalize.button({\n        ...parts.clearTrigger.attrs,\n        dir: prop(\"dir\"),\n        type: \"button\",\n        disabled,\n        hidden: context.get(\"acceptedFiles\").length === 0,\n        \"data-disabled\": dataAttr(disabled),\n        onClick(event) {\n          if (event.defaultPrevented) return;\n          if (disabled) return;\n          send({\n            type: \"FILES.CLEAR\"\n          });\n        }\n      });\n    }\n  };\n}\nvar machine = createMachine({\n  props({\n    props: props2\n  }) {\n    return {\n      minFileSize: 0,\n      maxFileSize: Number.POSITIVE_INFINITY,\n      maxFiles: 1,\n      allowDrop: true,\n      preventDocumentDrop: true,\n      defaultAcceptedFiles: [],\n      ...props2,\n      translations: {\n        dropzone: \"dropzone\",\n        itemPreview: file => `preview of ${file.name}`,\n        deleteFile: file => `delete file ${file.name}`,\n        ...props2.translations\n      }\n    };\n  },\n  initialState() {\n    return \"idle\";\n  },\n  context({\n    prop,\n    bindable,\n    getContext\n  }) {\n    return {\n      acceptedFiles: bindable(() => ({\n        defaultValue: prop(\"defaultAcceptedFiles\"),\n        value: prop(\"acceptedFiles\"),\n        isEqual: (a, b) => a.length === b?.length && a.every((file, i) => isFileEqual(file, b[i])),\n        hash(value) {\n          return value.map(file => `${file.name}-${file.size}`).join(\",\");\n        },\n        onChange(value) {\n          const ctx = getContext();\n          prop(\"onFileAccept\")?.({\n            files: value\n          });\n          prop(\"onFileChange\")?.({\n            acceptedFiles: value,\n            rejectedFiles: ctx.get(\"rejectedFiles\")\n          });\n        }\n      })),\n      rejectedFiles: bindable(() => ({\n        defaultValue: [],\n        isEqual: (a, b) => a.length === b?.length && a.every((file, i) => isFileEqual(file.file, b[i].file)),\n        onChange(value) {\n          const ctx = getContext();\n          prop(\"onFileReject\")?.({\n            files: value\n          });\n          prop(\"onFileChange\")?.({\n            acceptedFiles: ctx.get(\"acceptedFiles\"),\n            rejectedFiles: value\n          });\n        }\n      })),\n      transforming: bindable(() => ({\n        defaultValue: false\n      }))\n    };\n  },\n  computed: {\n    acceptAttr: ({\n      prop\n    }) => getAcceptAttrString(prop(\"accept\")),\n    multiple: ({\n      prop\n    }) => prop(\"maxFiles\") > 1\n  },\n  watch({\n    track,\n    context,\n    action\n  }) {\n    track([() => context.hash(\"acceptedFiles\")], () => {\n      action([\"syncInputElement\"]);\n    });\n  },\n  on: {\n    \"FILES.SET\": {\n      actions: [\"setFiles\"]\n    },\n    \"FILE.SELECT\": {\n      actions: [\"setEventFiles\"]\n    },\n    \"FILE.DELETE\": {\n      actions: [\"removeFile\"]\n    },\n    \"FILES.CLEAR\": {\n      actions: [\"clearFiles\"]\n    },\n    \"REJECTED_FILES.CLEAR\": {\n      actions: [\"clearRejectedFiles\"]\n    }\n  },\n  effects: [\"preventDocumentDrop\"],\n  states: {\n    idle: {\n      on: {\n        OPEN: {\n          actions: [\"openFilePicker\"]\n        },\n        \"DROPZONE.CLICK\": {\n          actions: [\"openFilePicker\"]\n        },\n        \"DROPZONE.FOCUS\": {\n          target: \"focused\"\n        },\n        \"DROPZONE.DRAG_OVER\": {\n          target: \"dragging\"\n        }\n      }\n    },\n    focused: {\n      on: {\n        \"DROPZONE.BLUR\": {\n          target: \"idle\"\n        },\n        OPEN: {\n          actions: [\"openFilePicker\"]\n        },\n        \"DROPZONE.CLICK\": {\n          actions: [\"openFilePicker\"]\n        },\n        \"DROPZONE.DRAG_OVER\": {\n          target: \"dragging\"\n        }\n      }\n    },\n    dragging: {\n      on: {\n        \"DROPZONE.DROP\": {\n          target: \"idle\",\n          actions: [\"setEventFiles\"]\n        },\n        \"DROPZONE.DRAG_LEAVE\": {\n          target: \"idle\"\n        }\n      }\n    }\n  },\n  implementations: {\n    effects: {\n      preventDocumentDrop({\n        prop,\n        scope\n      }) {\n        if (!prop(\"preventDocumentDrop\")) return;\n        if (!prop(\"allowDrop\")) return;\n        if (prop(\"disabled\")) return;\n        const doc = scope.getDoc();\n        const onDragOver = event => {\n          event?.preventDefault();\n        };\n        const onDrop = event => {\n          if (contains(getRootEl(scope), getEventTarget(event))) return;\n          event.preventDefault();\n        };\n        return callAll(addDomEvent(doc, \"dragover\", onDragOver, false), addDomEvent(doc, \"drop\", onDrop, false));\n      }\n    },\n    actions: {\n      syncInputElement({\n        scope,\n        context\n      }) {\n        queueMicrotask(() => {\n          const inputEl = getHiddenInputEl(scope);\n          if (!inputEl) return;\n          setInputFiles(inputEl, context.get(\"acceptedFiles\"));\n          const win = scope.getWin();\n          inputEl.dispatchEvent(new win.Event(\"change\", {\n            bubbles: true\n          }));\n        });\n      },\n      openFilePicker({\n        scope\n      }) {\n        raf(() => {\n          getHiddenInputEl(scope)?.click();\n        });\n      },\n      setFiles(params) {\n        const {\n          computed,\n          context,\n          event\n        } = params;\n        const {\n          acceptedFiles,\n          rejectedFiles\n        } = getEventFiles(params, event.files);\n        context.set(\"acceptedFiles\", computed(\"multiple\") ? acceptedFiles : acceptedFiles.length > 0 ? [acceptedFiles[0]] : []);\n        context.set(\"rejectedFiles\", rejectedFiles);\n      },\n      setEventFiles(params) {\n        const {\n          computed,\n          context,\n          event,\n          prop\n        } = params;\n        const currentAcceptedFiles = context.get(\"acceptedFiles\");\n        const currentRejectedFiles = context.get(\"rejectedFiles\");\n        const {\n          acceptedFiles,\n          rejectedFiles\n        } = getEventFiles(params, event.files, currentAcceptedFiles, currentRejectedFiles);\n        const set = files => {\n          if (computed(\"multiple\")) {\n            context.set(\"acceptedFiles\", prev => [...prev, ...files]);\n            context.set(\"rejectedFiles\", rejectedFiles);\n            return;\n          }\n          if (files.length) {\n            context.set(\"acceptedFiles\", [files[0]]);\n            context.set(\"rejectedFiles\", rejectedFiles);\n            return;\n          }\n          if (rejectedFiles.length) {\n            context.set(\"acceptedFiles\", context.get(\"acceptedFiles\"));\n            context.set(\"rejectedFiles\", rejectedFiles);\n          }\n        };\n        const transform = prop(\"transformFiles\");\n        if (transform) {\n          context.set(\"transforming\", true);\n          transform(acceptedFiles).then(set).catch(err => {\n            warn(`[zag-js/file-upload] error transforming files\n${err}`);\n          }).finally(() => {\n            context.set(\"transforming\", false);\n          });\n        } else {\n          set(acceptedFiles);\n        }\n      },\n      removeFile({\n        context,\n        event\n      }) {\n        const files = context.get(\"acceptedFiles\").filter(file => !isFileEqual(file, event.file));\n        const rejectedFiles = context.get(\"rejectedFiles\").filter(item => !isFileEqual(item.file, event.file));\n        context.set(\"acceptedFiles\", files);\n        context.set(\"rejectedFiles\", rejectedFiles);\n      },\n      clearRejectedFiles({\n        context\n      }) {\n        context.set(\"rejectedFiles\", []);\n      },\n      clearFiles({\n        context\n      }) {\n        context.set(\"acceptedFiles\", []);\n        context.set(\"rejectedFiles\", []);\n      }\n    }\n  }\n});\nvar props = createProps()([\"accept\", \"acceptedFiles\", \"allowDrop\", \"capture\", \"defaultAcceptedFiles\", \"dir\", \"directory\", \"disabled\", \"getRootNode\", \"id\", \"ids\", \"invalid\", \"locale\", \"maxFiles\", \"maxFileSize\", \"minFileSize\", \"name\", \"onFileAccept\", \"onFileChange\", \"onFileReject\", \"preventDocumentDrop\", \"required\", \"transformFiles\", \"translations\", \"validate\"]);\nvar splitProps = createSplitProps(props);\nvar itemProps = createProps()([\"file\"]);\nvar splitItemProps = createSplitProps(itemProps);\nexport { anatomy, connect, itemProps, machine, props, splitItemProps, splitProps };","map":{"version":3,"names":["createAnatomy","raf","addDomEvent","getWindow","contains","getEventTarget","dataAttr","visuallyHiddenStyle","isSelfTarget","getAcceptAttrString","isFileEqual","isValidFileType","isValidFileSize","getFileEntries","formatBytes","createProps","warn","callAll","createSplitProps","flatArray","createMachine","anatomy","parts","build","getRootId","ctx","ids","root","id","getDropzoneId","dropzone","getHiddenInputId","hiddenInput","getTriggerId","trigger","getLabelId","label","getItemId","item","getItemNameId","itemName","getItemSizeTextId","itemSizeText","getItemPreviewId","itemPreview","getRootEl","getById","getHiddenInputEl","getDropzoneEl","isEventWithFiles","event","target","dataTransfer","types","some","type","isFilesWithinRange","incomingCount","currentAcceptedFiles","prop","computed","length","getEventFiles","files","currentRejectedFiles","acceptedFiles","rejectedFiles","validateParams","forEach","file","accepted","acceptError","sizeMatch","sizeError","validateErrors","valid","push","errors","filter","Boolean","splice","setInputFiles","inputEl","win","DataTransfer","items","add","connect","service","normalize","state","send","scope","context","disabled","allowDrop","translations","dragging","matches","focused","transforming","get","openFilePicker","deleteFile","setFiles","count","clearRejectedFiles","clearFiles","getFileSize","size","createFileUrl","cb","getWin","url","URL","createObjectURL","revokeObjectURL","setClipboardFiles","dt","Array","from","reduce","acc","kind","getAsFile","getRootProps","element","attrs","dir","getDropzoneProps","props2","tabIndex","disableClick","role","onKeyDown","defaultPrevented","key","src","onClick","currentTarget","localName","preventDefault","onDragOver","stopPropagation","dropEffect","hasFiles","onDragLeave","relatedTarget","onDrop","then","onFocus","onBlur","getTriggerProps","button","getHiddenInputProps","input","required","capture","name","accept","webkitdirectory","multiple","value","onInput","style","getItemGroupProps","itemGroup","getItemProps","getItemNameProps","getItemSizeTextProps","getItemPreviewProps","getItemPreviewImageProps","isImage","startsWith","Error","img","itemPreviewImage","alt","getItemDeleteTriggerProps","itemDeleteTrigger","getLabelProps","htmlFor","getClearTriggerProps","clearTrigger","hidden","machine","props","minFileSize","maxFileSize","Number","POSITIVE_INFINITY","maxFiles","preventDocumentDrop","defaultAcceptedFiles","initialState","bindable","getContext","defaultValue","isEqual","a","b","every","i","hash","map","join","onChange","acceptAttr","watch","track","action","on","actions","effects","states","idle","OPEN","implementations","doc","getDoc","syncInputElement","queueMicrotask","dispatchEvent","Event","bubbles","click","params","set","setEventFiles","prev","transform","catch","err","finally","removeFile","splitProps","itemProps","splitItemProps"],"sources":["C:/Repos/devops-microservices-project/frontend/node_modules/@zag-js/file-upload/dist/index.mjs"],"sourcesContent":["import { createAnatomy } from '@zag-js/anatomy';\nimport { raf, addDomEvent, getWindow, contains, getEventTarget, dataAttr, visuallyHiddenStyle, isSelfTarget } from '@zag-js/dom-query';\nimport { getAcceptAttrString, isFileEqual, isValidFileType, isValidFileSize, getFileEntries } from '@zag-js/file-utils';\nimport { formatBytes } from '@zag-js/i18n-utils';\nimport { createProps } from '@zag-js/types';\nimport { warn, callAll, createSplitProps, flatArray } from '@zag-js/utils';\nimport { createMachine } from '@zag-js/core';\n\n// src/file-upload.anatomy.ts\nvar anatomy = createAnatomy(\"file-upload\").parts(\n  \"root\",\n  \"dropzone\",\n  \"item\",\n  \"itemDeleteTrigger\",\n  \"itemGroup\",\n  \"itemName\",\n  \"itemPreview\",\n  \"itemPreviewImage\",\n  \"itemSizeText\",\n  \"label\",\n  \"trigger\",\n  \"clearTrigger\"\n);\nvar parts = anatomy.build();\n\n// src/file-upload.dom.ts\nvar getRootId = (ctx) => ctx.ids?.root ?? `file:${ctx.id}`;\nvar getDropzoneId = (ctx) => ctx.ids?.dropzone ?? `file:${ctx.id}:dropzone`;\nvar getHiddenInputId = (ctx) => ctx.ids?.hiddenInput ?? `file:${ctx.id}:input`;\nvar getTriggerId = (ctx) => ctx.ids?.trigger ?? `file:${ctx.id}:trigger`;\nvar getLabelId = (ctx) => ctx.ids?.label ?? `file:${ctx.id}:label`;\nvar getItemId = (ctx, id) => ctx.ids?.item?.(id) ?? `file:${ctx.id}:item:${id}`;\nvar getItemNameId = (ctx, id) => ctx.ids?.itemName?.(id) ?? `file:${ctx.id}:item-name:${id}`;\nvar getItemSizeTextId = (ctx, id) => ctx.ids?.itemSizeText?.(id) ?? `file:${ctx.id}:item-size:${id}`;\nvar getItemPreviewId = (ctx, id) => ctx.ids?.itemPreview?.(id) ?? `file:${ctx.id}:item-preview:${id}`;\nvar getRootEl = (ctx) => ctx.getById(getRootId(ctx));\nvar getHiddenInputEl = (ctx) => ctx.getById(getHiddenInputId(ctx));\nvar getDropzoneEl = (ctx) => ctx.getById(getDropzoneId(ctx));\nfunction isEventWithFiles(event) {\n  const target = getEventTarget(event);\n  if (!event.dataTransfer) return !!target && \"files\" in target;\n  return event.dataTransfer.types.some((type) => {\n    return type === \"Files\" || type === \"application/x-moz-file\";\n  });\n}\nfunction isFilesWithinRange(ctx, incomingCount, currentAcceptedFiles) {\n  const { prop, computed } = ctx;\n  if (!computed(\"multiple\") && incomingCount > 1) return false;\n  if (!computed(\"multiple\") && incomingCount + currentAcceptedFiles.length === 2) return true;\n  if (incomingCount + currentAcceptedFiles.length > prop(\"maxFiles\")) return false;\n  return true;\n}\nfunction getEventFiles(ctx, files, currentAcceptedFiles = [], currentRejectedFiles = []) {\n  const { prop, computed } = ctx;\n  const acceptedFiles = [];\n  const rejectedFiles = [];\n  const validateParams = {\n    acceptedFiles: currentAcceptedFiles,\n    rejectedFiles: currentRejectedFiles\n  };\n  files.forEach((file) => {\n    const [accepted, acceptError] = isValidFileType(file, computed(\"acceptAttr\"));\n    const [sizeMatch, sizeError] = isValidFileSize(file, prop(\"minFileSize\"), prop(\"maxFileSize\"));\n    const validateErrors = prop(\"validate\")?.(file, validateParams);\n    const valid = validateErrors ? validateErrors.length === 0 : true;\n    if (accepted && sizeMatch && valid) {\n      acceptedFiles.push(file);\n    } else {\n      const errors = [acceptError, sizeError];\n      if (!valid) errors.push(...validateErrors ?? []);\n      rejectedFiles.push({ file, errors: errors.filter(Boolean) });\n    }\n  });\n  if (!isFilesWithinRange(ctx, acceptedFiles.length, currentAcceptedFiles)) {\n    acceptedFiles.forEach((file) => {\n      rejectedFiles.push({ file, errors: [\"TOO_MANY_FILES\"] });\n    });\n    acceptedFiles.splice(0);\n  }\n  return {\n    acceptedFiles,\n    rejectedFiles\n  };\n}\nfunction setInputFiles(inputEl, files) {\n  const win = getWindow(inputEl);\n  try {\n    if (\"DataTransfer\" in win) {\n      const dataTransfer = new win.DataTransfer();\n      files.forEach((file) => {\n        dataTransfer.items.add(file);\n      });\n      inputEl.files = dataTransfer.files;\n    }\n  } catch {\n  }\n}\n\n// src/file-upload.connect.ts\nfunction connect(service, normalize) {\n  const { state, send, prop, computed, scope, context } = service;\n  const disabled = prop(\"disabled\");\n  const allowDrop = prop(\"allowDrop\");\n  const translations = prop(\"translations\");\n  const dragging = state.matches(\"dragging\");\n  const focused = state.matches(\"focused\") && !disabled;\n  return {\n    dragging,\n    focused,\n    disabled: !!disabled,\n    transforming: context.get(\"transforming\"),\n    openFilePicker() {\n      if (disabled) return;\n      send({ type: \"OPEN\" });\n    },\n    deleteFile(file) {\n      send({ type: \"FILE.DELETE\", file });\n    },\n    acceptedFiles: context.get(\"acceptedFiles\"),\n    rejectedFiles: context.get(\"rejectedFiles\"),\n    setFiles(files) {\n      send({ type: \"FILES.SET\", files, count: files.length });\n    },\n    clearRejectedFiles() {\n      send({ type: \"REJECTED_FILES.CLEAR\" });\n    },\n    clearFiles() {\n      send({ type: \"FILES.CLEAR\" });\n    },\n    getFileSize(file) {\n      return formatBytes(file.size, prop(\"locale\"));\n    },\n    createFileUrl(file, cb) {\n      const win = scope.getWin();\n      const url = win.URL.createObjectURL(file);\n      cb(url);\n      return () => win.URL.revokeObjectURL(url);\n    },\n    setClipboardFiles(dt) {\n      if (disabled) return false;\n      const items = Array.from(dt?.items ?? []);\n      const files = items.reduce((acc, item) => {\n        if (item.kind !== \"file\") return acc;\n        const file = item.getAsFile();\n        if (!file) return acc;\n        return [...acc, file];\n      }, []);\n      if (!files.length) return false;\n      send({ type: \"FILES.SET\", files });\n      return true;\n    },\n    getRootProps() {\n      return normalize.element({\n        ...parts.root.attrs,\n        dir: prop(\"dir\"),\n        id: getRootId(scope),\n        \"data-disabled\": dataAttr(disabled),\n        \"data-dragging\": dataAttr(dragging)\n      });\n    },\n    getDropzoneProps(props2 = {}) {\n      return normalize.element({\n        ...parts.dropzone.attrs,\n        dir: prop(\"dir\"),\n        id: getDropzoneId(scope),\n        tabIndex: disabled || props2.disableClick ? void 0 : 0,\n        role: props2.disableClick ? \"application\" : \"button\",\n        \"aria-label\": translations.dropzone,\n        \"aria-disabled\": disabled,\n        \"data-invalid\": dataAttr(prop(\"invalid\")),\n        \"data-disabled\": dataAttr(disabled),\n        \"data-dragging\": dataAttr(dragging),\n        onKeyDown(event) {\n          if (disabled) return;\n          if (event.defaultPrevented) return;\n          if (!isSelfTarget(event)) return;\n          if (props2.disableClick) return;\n          if (event.key !== \"Enter\" && event.key !== \" \") return;\n          send({ type: \"DROPZONE.CLICK\", src: \"keydown\" });\n        },\n        onClick(event) {\n          if (disabled) return;\n          if (event.defaultPrevented) return;\n          if (props2.disableClick) return;\n          if (!isSelfTarget(event)) return;\n          if (event.currentTarget.localName === \"label\") {\n            event.preventDefault();\n          }\n          send({ type: \"DROPZONE.CLICK\" });\n        },\n        onDragOver(event) {\n          if (disabled) return;\n          if (!allowDrop) return;\n          event.preventDefault();\n          event.stopPropagation();\n          try {\n            event.dataTransfer.dropEffect = \"copy\";\n          } catch {\n          }\n          const hasFiles = isEventWithFiles(event);\n          if (!hasFiles) return;\n          const count = event.dataTransfer.items.length;\n          send({ type: \"DROPZONE.DRAG_OVER\", count });\n        },\n        onDragLeave(event) {\n          if (disabled) return;\n          if (!allowDrop) return;\n          if (contains(event.currentTarget, event.relatedTarget)) return;\n          send({ type: \"DROPZONE.DRAG_LEAVE\" });\n        },\n        onDrop(event) {\n          if (disabled) return;\n          if (allowDrop) {\n            event.preventDefault();\n            event.stopPropagation();\n          }\n          const hasFiles = isEventWithFiles(event);\n          if (disabled || !hasFiles) return;\n          getFileEntries(event.dataTransfer.items, prop(\"directory\")).then((files) => {\n            send({ type: \"DROPZONE.DROP\", files: flatArray(files) });\n          });\n        },\n        onFocus() {\n          if (disabled) return;\n          send({ type: \"DROPZONE.FOCUS\" });\n        },\n        onBlur() {\n          if (disabled) return;\n          send({ type: \"DROPZONE.BLUR\" });\n        }\n      });\n    },\n    getTriggerProps() {\n      return normalize.button({\n        ...parts.trigger.attrs,\n        dir: prop(\"dir\"),\n        id: getTriggerId(scope),\n        disabled,\n        \"data-disabled\": dataAttr(disabled),\n        \"data-invalid\": dataAttr(prop(\"invalid\")),\n        type: \"button\",\n        onClick(event) {\n          if (disabled) return;\n          if (contains(getDropzoneEl(scope), event.currentTarget)) {\n            event.stopPropagation();\n          }\n          send({ type: \"OPEN\" });\n        }\n      });\n    },\n    getHiddenInputProps() {\n      return normalize.input({\n        id: getHiddenInputId(scope),\n        tabIndex: -1,\n        disabled,\n        type: \"file\",\n        required: prop(\"required\"),\n        capture: prop(\"capture\"),\n        name: prop(\"name\"),\n        accept: computed(\"acceptAttr\"),\n        webkitdirectory: prop(\"directory\") ? \"\" : void 0,\n        multiple: computed(\"multiple\") || prop(\"maxFiles\") > 1,\n        onClick(event) {\n          event.stopPropagation();\n          event.currentTarget.value = \"\";\n        },\n        onInput(event) {\n          if (disabled) return;\n          const { files } = event.currentTarget;\n          send({ type: \"FILE.SELECT\", files: files ? Array.from(files) : [] });\n        },\n        style: visuallyHiddenStyle\n      });\n    },\n    getItemGroupProps() {\n      return normalize.element({\n        ...parts.itemGroup.attrs,\n        dir: prop(\"dir\"),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemProps(props2) {\n      const { file } = props2;\n      return normalize.element({\n        ...parts.item.attrs,\n        dir: prop(\"dir\"),\n        id: getItemId(scope, file.name),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemNameProps(props2) {\n      const { file } = props2;\n      return normalize.element({\n        ...parts.itemName.attrs,\n        dir: prop(\"dir\"),\n        id: getItemNameId(scope, file.name),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemSizeTextProps(props2) {\n      const { file } = props2;\n      return normalize.element({\n        ...parts.itemSizeText.attrs,\n        dir: prop(\"dir\"),\n        id: getItemSizeTextId(scope, file.name),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemPreviewProps(props2) {\n      const { file } = props2;\n      return normalize.element({\n        ...parts.itemPreview.attrs,\n        dir: prop(\"dir\"),\n        id: getItemPreviewId(scope, file.name),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemPreviewImageProps(props2) {\n      const { file, url } = props2;\n      const isImage = file.type.startsWith(\"image/\");\n      if (!isImage) {\n        throw new Error(\"Preview Image is only supported for image files\");\n      }\n      return normalize.img({\n        ...parts.itemPreviewImage.attrs,\n        alt: translations.itemPreview?.(file),\n        src: url,\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getItemDeleteTriggerProps(props2) {\n      const { file } = props2;\n      return normalize.button({\n        ...parts.itemDeleteTrigger.attrs,\n        dir: prop(\"dir\"),\n        type: \"button\",\n        disabled,\n        \"data-disabled\": dataAttr(disabled),\n        \"aria-label\": translations.deleteFile?.(file),\n        onClick() {\n          if (disabled) return;\n          send({ type: \"FILE.DELETE\", file });\n        }\n      });\n    },\n    getLabelProps() {\n      return normalize.label({\n        ...parts.label.attrs,\n        dir: prop(\"dir\"),\n        id: getLabelId(scope),\n        htmlFor: getHiddenInputId(scope),\n        \"data-disabled\": dataAttr(disabled)\n      });\n    },\n    getClearTriggerProps() {\n      return normalize.button({\n        ...parts.clearTrigger.attrs,\n        dir: prop(\"dir\"),\n        type: \"button\",\n        disabled,\n        hidden: context.get(\"acceptedFiles\").length === 0,\n        \"data-disabled\": dataAttr(disabled),\n        onClick(event) {\n          if (event.defaultPrevented) return;\n          if (disabled) return;\n          send({ type: \"FILES.CLEAR\" });\n        }\n      });\n    }\n  };\n}\nvar machine = createMachine({\n  props({ props: props2 }) {\n    return {\n      minFileSize: 0,\n      maxFileSize: Number.POSITIVE_INFINITY,\n      maxFiles: 1,\n      allowDrop: true,\n      preventDocumentDrop: true,\n      defaultAcceptedFiles: [],\n      ...props2,\n      translations: {\n        dropzone: \"dropzone\",\n        itemPreview: (file) => `preview of ${file.name}`,\n        deleteFile: (file) => `delete file ${file.name}`,\n        ...props2.translations\n      }\n    };\n  },\n  initialState() {\n    return \"idle\";\n  },\n  context({ prop, bindable, getContext }) {\n    return {\n      acceptedFiles: bindable(() => ({\n        defaultValue: prop(\"defaultAcceptedFiles\"),\n        value: prop(\"acceptedFiles\"),\n        isEqual: (a, b) => a.length === b?.length && a.every((file, i) => isFileEqual(file, b[i])),\n        hash(value) {\n          return value.map((file) => `${file.name}-${file.size}`).join(\",\");\n        },\n        onChange(value) {\n          const ctx = getContext();\n          prop(\"onFileAccept\")?.({ files: value });\n          prop(\"onFileChange\")?.({ acceptedFiles: value, rejectedFiles: ctx.get(\"rejectedFiles\") });\n        }\n      })),\n      rejectedFiles: bindable(() => ({\n        defaultValue: [],\n        isEqual: (a, b) => a.length === b?.length && a.every((file, i) => isFileEqual(file.file, b[i].file)),\n        onChange(value) {\n          const ctx = getContext();\n          prop(\"onFileReject\")?.({ files: value });\n          prop(\"onFileChange\")?.({ acceptedFiles: ctx.get(\"acceptedFiles\"), rejectedFiles: value });\n        }\n      })),\n      transforming: bindable(() => ({\n        defaultValue: false\n      }))\n    };\n  },\n  computed: {\n    acceptAttr: ({ prop }) => getAcceptAttrString(prop(\"accept\")),\n    multiple: ({ prop }) => prop(\"maxFiles\") > 1\n  },\n  watch({ track, context, action }) {\n    track([() => context.hash(\"acceptedFiles\")], () => {\n      action([\"syncInputElement\"]);\n    });\n  },\n  on: {\n    \"FILES.SET\": {\n      actions: [\"setFiles\"]\n    },\n    \"FILE.SELECT\": {\n      actions: [\"setEventFiles\"]\n    },\n    \"FILE.DELETE\": {\n      actions: [\"removeFile\"]\n    },\n    \"FILES.CLEAR\": {\n      actions: [\"clearFiles\"]\n    },\n    \"REJECTED_FILES.CLEAR\": {\n      actions: [\"clearRejectedFiles\"]\n    }\n  },\n  effects: [\"preventDocumentDrop\"],\n  states: {\n    idle: {\n      on: {\n        OPEN: {\n          actions: [\"openFilePicker\"]\n        },\n        \"DROPZONE.CLICK\": {\n          actions: [\"openFilePicker\"]\n        },\n        \"DROPZONE.FOCUS\": {\n          target: \"focused\"\n        },\n        \"DROPZONE.DRAG_OVER\": {\n          target: \"dragging\"\n        }\n      }\n    },\n    focused: {\n      on: {\n        \"DROPZONE.BLUR\": {\n          target: \"idle\"\n        },\n        OPEN: {\n          actions: [\"openFilePicker\"]\n        },\n        \"DROPZONE.CLICK\": {\n          actions: [\"openFilePicker\"]\n        },\n        \"DROPZONE.DRAG_OVER\": {\n          target: \"dragging\"\n        }\n      }\n    },\n    dragging: {\n      on: {\n        \"DROPZONE.DROP\": {\n          target: \"idle\",\n          actions: [\"setEventFiles\"]\n        },\n        \"DROPZONE.DRAG_LEAVE\": {\n          target: \"idle\"\n        }\n      }\n    }\n  },\n  implementations: {\n    effects: {\n      preventDocumentDrop({ prop, scope }) {\n        if (!prop(\"preventDocumentDrop\")) return;\n        if (!prop(\"allowDrop\")) return;\n        if (prop(\"disabled\")) return;\n        const doc = scope.getDoc();\n        const onDragOver = (event) => {\n          event?.preventDefault();\n        };\n        const onDrop = (event) => {\n          if (contains(getRootEl(scope), getEventTarget(event))) return;\n          event.preventDefault();\n        };\n        return callAll(addDomEvent(doc, \"dragover\", onDragOver, false), addDomEvent(doc, \"drop\", onDrop, false));\n      }\n    },\n    actions: {\n      syncInputElement({ scope, context }) {\n        queueMicrotask(() => {\n          const inputEl = getHiddenInputEl(scope);\n          if (!inputEl) return;\n          setInputFiles(inputEl, context.get(\"acceptedFiles\"));\n          const win = scope.getWin();\n          inputEl.dispatchEvent(new win.Event(\"change\", { bubbles: true }));\n        });\n      },\n      openFilePicker({ scope }) {\n        raf(() => {\n          getHiddenInputEl(scope)?.click();\n        });\n      },\n      setFiles(params) {\n        const { computed, context, event } = params;\n        const { acceptedFiles, rejectedFiles } = getEventFiles(params, event.files);\n        context.set(\n          \"acceptedFiles\",\n          computed(\"multiple\") ? acceptedFiles : acceptedFiles.length > 0 ? [acceptedFiles[0]] : []\n        );\n        context.set(\"rejectedFiles\", rejectedFiles);\n      },\n      setEventFiles(params) {\n        const { computed, context, event, prop } = params;\n        const currentAcceptedFiles = context.get(\"acceptedFiles\");\n        const currentRejectedFiles = context.get(\"rejectedFiles\");\n        const { acceptedFiles, rejectedFiles } = getEventFiles(\n          params,\n          event.files,\n          currentAcceptedFiles,\n          currentRejectedFiles\n        );\n        const set = (files) => {\n          if (computed(\"multiple\")) {\n            context.set(\"acceptedFiles\", (prev) => [...prev, ...files]);\n            context.set(\"rejectedFiles\", rejectedFiles);\n            return;\n          }\n          if (files.length) {\n            context.set(\"acceptedFiles\", [files[0]]);\n            context.set(\"rejectedFiles\", rejectedFiles);\n            return;\n          }\n          if (rejectedFiles.length) {\n            context.set(\"acceptedFiles\", context.get(\"acceptedFiles\"));\n            context.set(\"rejectedFiles\", rejectedFiles);\n          }\n        };\n        const transform = prop(\"transformFiles\");\n        if (transform) {\n          context.set(\"transforming\", true);\n          transform(acceptedFiles).then(set).catch((err) => {\n            warn(`[zag-js/file-upload] error transforming files\n${err}`);\n          }).finally(() => {\n            context.set(\"transforming\", false);\n          });\n        } else {\n          set(acceptedFiles);\n        }\n      },\n      removeFile({ context, event }) {\n        const files = context.get(\"acceptedFiles\").filter((file) => !isFileEqual(file, event.file));\n        const rejectedFiles = context.get(\"rejectedFiles\").filter((item) => !isFileEqual(item.file, event.file));\n        context.set(\"acceptedFiles\", files);\n        context.set(\"rejectedFiles\", rejectedFiles);\n      },\n      clearRejectedFiles({ context }) {\n        context.set(\"rejectedFiles\", []);\n      },\n      clearFiles({ context }) {\n        context.set(\"acceptedFiles\", []);\n        context.set(\"rejectedFiles\", []);\n      }\n    }\n  }\n});\nvar props = createProps()([\n  \"accept\",\n  \"acceptedFiles\",\n  \"allowDrop\",\n  \"capture\",\n  \"defaultAcceptedFiles\",\n  \"dir\",\n  \"directory\",\n  \"disabled\",\n  \"getRootNode\",\n  \"id\",\n  \"ids\",\n  \"invalid\",\n  \"locale\",\n  \"maxFiles\",\n  \"maxFileSize\",\n  \"minFileSize\",\n  \"name\",\n  \"onFileAccept\",\n  \"onFileChange\",\n  \"onFileReject\",\n  \"preventDocumentDrop\",\n  \"required\",\n  \"transformFiles\",\n  \"translations\",\n  \"validate\"\n]);\nvar splitProps = createSplitProps(props);\nvar itemProps = createProps()([\"file\"]);\nvar splitItemProps = createSplitProps(itemProps);\n\nexport { anatomy, connect, itemProps, machine, props, splitItemProps, splitProps };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}